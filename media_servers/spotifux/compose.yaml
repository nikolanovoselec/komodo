services:
  spotifux:
    image: ghcr.io/nikolanovoselec/spotifux:v4.0.0
    user: "1000:1000"
    volumes:
      - /docker/configs/spotifux/data:/app/data
      - /mnt/music/Spotifux:/app/downloads
      - /docker/configs/spotifux/logs:/app/logs
      - /docker/configs/spotifux/.cache:/app/.cache
    ports:
      - 7171:7171
    container_name: media_servers_spotifux
    restart: unless-stopped
    depends_on:
      - redis
    network_mode: "service:redis"
  redis:
    image: redis:alpine
    container_name: media_servers_spotifux_redis
    restart: unless-stopped
    ports:
      - 6379:6379
    volumes:
      - /docker/configs/spotifux/redis-data:/data
    command: sh -c 'redis-server --requirepass "${SPOTIFUX_REDIS_PASSWORD}" --appendonly yes'
  spotifux-auth:
    image: ghcr.io/spotizerr/spotizerr-auth:1.1.1
    restart: unless-stopped
    container_name: media_servers_spotifux_auth
    profiles:
      - auth
    network_mode: host
    environment:
      SPOTIFY_CLIENT_ID: ${SPOTIFY_CLIENT_ID}
      SPOTIFY_CLIENT_SECRET: ${SPOTIFY_CLIENT_SECRET}
      SPOTIFUX_BASE_URL: ${SPOTIFUX_BASE_URL}